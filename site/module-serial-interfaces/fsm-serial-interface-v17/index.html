
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.5">
    
    
      
        <title>StateMachineSerialInterface - Bpod Wiki testing</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Aldrich">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#statemachineserialinterface" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Bpod Wiki testing" class="md-header__button md-logo" aria-label="Bpod Wiki testing" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/17090284?v=4" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bpod Wiki testing
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              StateMachineSerialInterface
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sanworks/Bpod_Gen2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Sanworks/Bpod_Gen2
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Bpod Wiki testing" class="md-nav__button md-logo" aria-label="Bpod Wiki testing" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/17090284?v=4" alt="logo">

    </a>
    Bpod Wiki testing
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sanworks/Bpod_Gen2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Sanworks/Bpod_Gen2
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/general-concepts/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.27 17.05A2.991 2.991 0 0 1 4 22c-1.66 0-3-1.34-3-3s1.34-3 3-3c.18 0 .36 0 .53.05l3.07-5.36-1.74-.99 4.09-1.12 1.12 4.09-1.74-.99-3.06 5.37M20 16c-1.3 0-2.4.84-2.82 2H11v-2l-3 3 3 3v-2h6.18c.42 1.16 1.52 2 2.82 2 1.66 0 3-1.34 3-3s-1.34-3-3-3m-8-8c.18 0 .36 0 .53-.05l3.07 5.36-1.74.99 4.09 1.12 1.12-4.09-1.74.99-3.06-5.37A2.991 2.991 0 0 0 12 2c-1.66 0-3 1.34-3 3s1.34 3 3 3Z"/></svg>
  
  <span class="md-ellipsis">
    General concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/function-reference/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.42 5.29c-1.1-.1-2.07.71-2.17 1.82L10 10h2.82v2h-3l-.44 5.07A4.001 4.001 0 0 1 2 18.83l1.5-1.5c.33 1.05 1.46 1.64 2.5 1.3.78-.24 1.33-.93 1.4-1.74L7.82 12h-3v-2H8l.27-3.07a4.01 4.01 0 0 1 4.33-3.65c1.26.11 2.4.81 3.06 1.89l-1.5 1.5c-.25-.77-.93-1.31-1.74-1.38M22 13.65l-1.41-1.41-2.83 2.83-2.83-2.83-1.43 1.41 2.85 2.85-2.85 2.81 1.43 1.41 2.83-2.83 2.83 2.83L22 19.31l-2.83-2.81L22 13.65Z"/></svg>
  
  <span class="md-ellipsis">
    Function reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/serial-interfaces/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.45 17.45 1 12l5.45-5.45 1.41 1.41L4.83 11h14.34l-3.03-3.04 1.41-1.41L23 12l-5.45 5.45-1.41-1.41L19.17 13H4.83l3.03 3.04-1.41 1.41Z"/></svg>
  
  <span class="md-ellipsis">
    Serial interfaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/modules/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 15h2v3h2v-3h2v3h2v-3h2v3h2V9h-4V6H9v3H5v9h2v-3M4.38 3h15.25A2.37 2.37 0 0 1 22 5.38v14.25A2.37 2.37 0 0 1 19.63 22H4.38A2.37 2.37 0 0 1 2 19.63V5.38C2 4.06 3.06 3 4.38 3Z"/></svg>
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/analog-input-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AnalogInputModule()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/audioplayer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BpodAudioPlayer()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/dds-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDSModule()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/hifi-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BpodHiFi()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/I2C-messenger-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    I2CMessenger()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/pulsepal-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PulsePalModule()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/rotary-encoder-module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RotaryEncoderModule()
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../module-documentation/waveplayer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BpodWavePlayer()
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Serial Interfaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Serial Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../analogue-input-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analog Input Module Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../audioplayer-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AudioPlayer Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../blink-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blink Module Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hifi-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HiFi Module Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../port-array-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Port Array Module Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../rotary-encoder-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rotary Encoder Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../valve-module-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Valve Module Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../waveplayer-serial-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WavePlayer Serial Interface
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assembly
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assembly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General Guides and Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            General Guides and Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../install-and-update/installing-bpod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing Bpod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/general-build-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General build guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/bench-testing-bpod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bench-testing Bpod
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software and Firmware Updates
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Software and Firmware Updates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../install-and-update/software-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../install-and-update/firmware-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firmware update
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    State Machines
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            State Machines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/state-machine-assembly-0_5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine 0.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/state-machine-assembly-0_9-1_0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine 0.9 - 1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/state-machine-assembly-2_3-2_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine 2.3-2.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/state-machine-assembly-2_5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine 2.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/state-machine-assembly-2%2B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine 2+
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/analog-input-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analog Input Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/analog-output-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analog Output Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/arduino-shield-0-5-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arduino Shield 0.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/arduino-shield-gen2-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arduino Shield Gen2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/dds-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDS Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/ethernet-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ethernet Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/hifi-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HiFi Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/lickometer-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lickometer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/mouse-behavior-port-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mouse Behavior Port Assembly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/mouse-box-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mouse Box Assembly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/neuralynx-sync-board-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bpod/Neuralynx sync board assembly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/open-ephys-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bpod/OpenEphys sync board
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/port-array-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Port Array Module Assembly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/port-breakout-board-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Port interface board
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/raspberry-pi-shim-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Raspberry Pi Shim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/rotary-encoder-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rotary Encoder Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/snes-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNES Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/teensy-shield-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Teensy Shield
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/valve-driver-module-assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Valve Driver Module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    External links
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            External links
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://sanworks.io" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sanworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://sanworks.io/forums" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forums
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/sanworks/Bpod_Gen2" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-menu" class="md-nav__link">
    Command Menu
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/ogeesan/bpod-docs-testing/tree/main/docs/module-serial-interfaces/fsm-serial-interface-v17.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="statemachineserialinterface">StateMachineSerialInterface</h1>
<p>Firmware version <strong>17</strong></p>
<h2 id="description">Description</h2>
<p>Allows software (i.e. Matlab, Python) to communicate with a Bpod state machine via its USB serial port.</p>
<p>This document describes the format of byte strings to send to the state machine's USB serial port, and what bytes to expect in return.</p>
<h2 id="command-menu">Command Menu</h2>
<p>The first byte sent to the Bpod state machine accesses a command menu, where different bytes specify different functions.</p>
<p>The command bytes are:</p>
<ul>
<li>'<strong>6</strong>' (ASCII 54): <strong>Hand shake</strong> (used to confirm a valid connection to the state machine).<ul>
<li>The state machine returns a byte: '5' (ASCII 53) to confirm the connection.</li>
</ul>
</li>
<li>'<strong>F</strong>' (ASCII 70): <strong>Return firmware version and machine type</strong><ul>
<li>The state machine replies with the following bytes:</li>
<li>FirmwareVersion(2 bytes; 16-bit int)</li>
<li>MachineType (2 bytes; 16-bit int). <em>MachineType is: 1 (State Machine hardware v0.5-0.9) or 2 (pocket state machine)</em></li>
</ul>
</li>
<li>'<strong>H</strong>' (ASCII 72): <strong>Return the state machine's on-board hardware configuration (excluding modules)</strong>.<ul>
<li>The state machine replies with the following bytes:<ul>
<li>MaxStates(2 bytes; 16-bit int); <em>maximum number of supported states in a single state machine description</em></li>
<li>TimerPeriod(2 bytes; 16-bit int); <em>the period (in microseconds) of the state machine's refresh cycle during a trial</em></li>
<li>maxSerialEvents(1 byte); <em>the maximum number of behavior events that can be allocated among connected modules</em></li>
<li>nGlobalTimers (1 byte); <em>the number of global timers supported</em></li>
<li>nGlobalCounters (1 byte); <em>the number of global counters supported</em></li>
<li>nConditions (1 byte); <em>the number of condition-events supported</em></li>
<li>nInputs (1 byte); <em>the number of channels in the state machine's input channel description array</em></li>
<li>inputDescriptionArray (1 byte x nInputs); <em>an array indicating the state machine's onboard input channel types</em></li>
<li>nOutputs (1 byte); <em>the number of channels in the state machine's output channel description array</em></li>
<li>outputDescriptionArray (1 byte x nOutputs); <em>a byte array indicating the state machine's onboard output channel types</em></li>
</ul>
</li>
</ul>
</li>
<li>'<strong>M</strong>' (ASCII 77): <strong>Return information describing the state machine's connected modules</strong><ul>
<li>The state machine replies with the following bytes:<ul>
<li>for each module (character 'U') in outputDescriptionArray (see 'H' above)<ul>
<li>moduleConnected (1 byte); 1 if a module was found, 0 if not.</li>
<li>if moduleConnected == 1<ul>
<li>moduleFirmwareVersion (4 bytes; 32-bit int) - <em>firmware version reported by the module</em></li>
<li>moduleNameLength (1 byte); <em>length of module name, in characters</em></li>
<li>moduleName (1 x moduleNameLength bytes); <em>a character array with the module name</em></li>
<li>moreInfoFollows (1 byte); <em>0 if module description is complete, 1 if more data follows</em></li>
<li>while moreInfoFollows == 1<ul>
<li>infoType (1 byte); <em>Type of info returned</em></li>
<li>if infoType == '<strong>#</strong>' (ASCII 35); <em>code to request for a specific number of serial events</em><ul>
<li>nEvents(1 byte); <em>number of serial events requested</em></li>
</ul>
</li>
<li>elseif infoType == '<strong>E</strong>' (ASCII 69) - <em>code to</em> <em>assign names to event bytes returned from this module to the state machine</em><ul>
<li>nEventNames (1 byte); number of event names to transmit</li>
<li>for 1 to nEventNames<ul>
<li>eventNameLength (1 byte); length of this event name</li>
<li>eventName (1 x eventNameLength bytes); a character array with the event name</li>
</ul>
</li>
</ul>
</li>
<li>end</li>
</ul>
</li>
<li>end<ul>
<li>moreInfoFollows (1 byte); 0 if module description is complete, 1 if more data follows</li>
</ul>
</li>
</ul>
</li>
<li>end</li>
</ul>
</li>
<li>end</li>
<li>end</li>
</ul>
</li>
<li>'<strong>%</strong>' (ASCII 37): <strong>Set number of behavior events allocated to each module</strong>. '#' (byte 0) is followed by:</li>
<li>Bytes 1-nModules: a byte for each module, indicating the number of behavior events it can generate.<ul>
<li><em>NOTE: nModules is the sum of (character 'U') in outputDescriptionArray returned by the state machine (see 'H' above)</em></li>
</ul>
</li>
<li>The state machine returns a byte (1) to confirm that it has finished setting each module's event allocation.</li>
<li><em>NOTE: By default, the maximum number of events (see 'H' -&gt; maxSerialEvents above) is distributed equally among modules. If a module requests a specific number of events (see 'M' -&gt; '#' above), the software (MATLAB / Python) must calculate the reallocation using the set of requests, and then use this command ('%') to update the state machine.</em></li>
<li>'<strong>E</strong>' (ASCII 69): <strong>Set the state of each input channel (enabled/disabled)</strong>. 'E' (byte 0) is followed by:</li>
<li>Bytes 1-nInputs: a byte for each input channel, indicating whether it is enabled (1) or disabled (0).<ul>
<li><em>nInputs must exist, having been returned from the 'H' command (above)</em></li>
<li>Generally, low-impedance inputs that are not connected to a signal source or tied to a pull-down resistor should be disabled.<ul>
<li>On the Bpod state machine, only the port input channels (i.e. photogates) are low impedance inputs.</li>
</ul>
</li>
</ul>
</li>
<li>The state machine returns a byte (1) to confirm that it has finished setting each channel's enabled property.</li>
<li>'<strong>J</strong>' (ASCII 74): <strong>Enable/Disable relay of incoming bytes from one module to the USB port</strong>. 'J' (byte 0) is followed by:</li>
<li>Byte 1: the module number to enable or disable <em>(indexed by 0)</em></li>
<li>Byte 2: the state of the module (0 = relay off, 1 = relay on)</li>
</ul>
</li>
<li>'<strong>K</strong>' (ASCII 87): <strong>Set a state synchronization channel</strong>. 'K' (byte 0) is followed by:<ul>
<li>Byte 1: the digital output channel to use for synchronization. <em>This channel is an index of outputDescriptionArray (see 'H' above).</em></li>
<li>Byte 2: the synchronization mode. Valid modes are:<ul>
<li>0: Channel set high on trial start and low on trial end</li>
<li>1: Channel switches logic states with each state transition</li>
</ul>
</li>
<li>The state machine returns a byte (1) to confirm that it has finished setting the sync channel configuration.</li>
</ul>
</li>
<li>'<strong>O</strong>' (ASCII 79): <strong>Override digital output line state</strong>. 'O' (byte 0) is followed by:<ul>
<li>Byte 1: the digital output channel to override. <em>This channel is an index of outputDescriptionArray (see 'H' above).</em></li>
<li>Byte 2: the new state of the channel<ul>
<li>If outputDescriptionArray[index] is a digital line (D,B,W), Byte 2 should be (1 = high, 0 = low)</li>
<li>If outputDescriptionArray[index] is a PWM line (P), Byte 2 should be the new PWM duty cycle (0-255)</li>
<li>If outputDescriptionArray[index] is a valve bank (S), Byte 2 should be a byte whose bits set the state of the 8 valves.</li>
</ul>
</li>
</ul>
</li>
<li>'<strong>I</strong>' (ASCII 73): <strong>Read the state of a digital input channel</strong>. 'I' (byte 0) is followed by:<ul>
<li>Byte 1: the digital input channel to read. <em>This channel is an index of inputDescriptionArray (see 'H' above).</em><ul>
<li>The state machine will return:<ul>
<li>0 if the channel's logic level is low</li>
<li>1 if the channel's logic level is high.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>'<strong>T</strong>' (ASCII 84): <strong>Transmit a string of bytes to a connected module</strong>. 'T' (byte 0) is followed by:<ul>
<li>Byte 1: the index of the targeted module.<ul>
<li>The module index is in range 0 -&gt; max number of modules (instances of 'U' in outputDescriptionArray; see 'H' above)</li>
<li>Byte 2: nBytes <em>(number of bytes in the message)</em></li>
<li>Bytes 3 --&gt; (2+nBytes): <em>The message to transmit</em></li>
</ul>
</li>
</ul>
</li>
<li>'<strong>L</strong>' (ASCII 76): <strong>Store a list of 1-3 byte serial messages, which can later be sent to modules by message index</strong>. 'L' (byte 0) is followed by:<ul>
<li>Byte 1: the index of the targeted module. <em>(Each module has its own message library)</em><ul>
<li><em>The module index is in range 0 -&gt; max number of modules (instances of 'U' in outputDescriptionArray; see 'H' above)</em></li>
</ul>
</li>
<li>Byte 2: nMessages <em>(the number of messages to store)</em><ul>
<li>for each message between 1 and nMessages<ul>
<li>MessageIndex (1 byte; 1-255)</li>
<li>MessageLength (1 byte; 1-3)</li>
<li>for 1 to MessageLength<ul>
<li>1 Byte (The next byte of the current message)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>The state machine returns a byte (1) to confirm that the specified channel's message library has been updated.</li>
</ul>
</li>
<li>'<strong>&gt;</strong>' (ASCII 62): <strong>Clear the serial message libraries</strong>. No data follows.<ul>
<li>The state machine restores each message to default - a message of length 1, whose value is equal to its index.</li>
<li>The state machine returns a byte (1) to confirm that the message libraries have been cleared.</li>
</ul>
</li>
<li>'<strong>U</strong>' (ASCII 85): <strong>Transmit a stored serial message (by index) to a connected module</strong>. 'U' (byte 0) is followed by:<ul>
<li>Byte 1: the index of the targeted module.</li>
<li>The module index is in range 0 -&gt; max number of modules (instances of 'U' in outputDescriptionArray; see 'H' above)</li>
<li>Byte 2: the index of the message to send.</li>
</ul>
</li>
<li>'<strong>V</strong>' (ASCII 86): <strong>Manually override an input channel, creating a virtual event</strong>. 'V' (byte 0) is followed by:<ul>
<li>Byte 1: the input channel to override. This channel is an index of inputDescriptionArray (see 'H' above).</li>
<li>Byte 2: the new value of the channel (0 = low, 1 = high).</li>
<li>NOTE: If a channel is overridden, it will remain in the overridden state regardless of what signals arrive. The channel must be reset with a second call to 'V' in order to return control to the hardware.</li>
</ul>
</li>
<li>'<strong>C</strong>' (ASCII 67): <strong>Transmit a state machine description to the state machine device</strong>. 'C' (byte 0) is followed by:<ul>
<li>Bytes 1-2: nBytes <em>(the number of bytes in the state machine description, NOT including the first 3 bytes; 'C' and nBytes)</em></li>
<li>Byte 3: nStates <em>(the number of states in the state machine description)</em></li>
<li>for each state s between 1 and nStates<ul>
<li>TimerMatrix[s] (1 byte) - <em>The state to go to if the state timer elapses</em></li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>nOverrides (1 byte) - The number of <strong>events</strong> handled in this state (overriding default of not-handled)</li>
<li>if nOverrides &gt; 0<ul>
<li>for each event e between 1 and nOverrides<ul>
<li>thisEvent (1 byte) - <em>(the numeric code of the event handled in state s)</em></li>
<li>thisState (1 byte) - <em>(the state to go to if thisEvent occurs in state s)</em></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>nOverrides (1 byte): <em>The number of</em> <em><strong>outputs</strong></em> <em>controlled in this state (overriding default of no output)</em></li>
<li>if nOverrides &gt; 0<ul>
<li>for each output channel between 1 and nOverrides<ul>
<li>thisOutputChannel (1 byte) - <em>(the index of the target output channel outputDescriptionArray)</em></li>
<li>thisOutputValue (1 byte) - <em>(the value of the output channel)</em></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>for each state between 1 and nStates<ul>
<li>nOverrides (1 byte): <em>The number of</em> <em><strong>global timer start events</strong></em> <em>handled in this state (overriding default of none)</em></li>
<li>if nOverrides &gt; 0<ul>
<li>for each timer t between 1 and nOverrides<ul>
<li>thisTimer (1 byte) - <em>(the index of the global timer whose start-events are handled)</em></li>
</ul>
</li>
<li>thisState (1 byte) - <em>(the state to go to if thisTimer's start event occurs)</em></li>
</ul>
</li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>nOverrides (1 byte): <em>The number of</em> <em><strong>global timer end events</strong></em> <em>handled in this state (overriding default of none)</em></li>
<li>if nOverrides &gt; 0<ul>
<li>for each timer t between 1 and nOverrides<ul>
<li>thisTimer (1 byte) - <em>(the index of the global timer whose end-events are handled)</em></li>
</ul>
</li>
<li>thisState (1 byte) - <em>(the state to go to if thisTimer's end event occurs)</em></li>
</ul>
</li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>nOverrides (1 byte): <em>The number of</em> <em><strong>global counter threshold events</strong></em> <em>handled in this state (overriding default of none)</em></li>
<li>if nOverrides &gt; 0<ul>
<li>for each counter c between 1 and nOverrides<ul>
<li>thisCounter (1 byte) - <em>(the index of the global counter whose threshold events are handled)</em></li>
</ul>
</li>
<li>thisState (1 byte) - <em>(the state to go to if thisCounter's threshold event occurs)</em></li>
</ul>
</li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>nOverrides (1 byte): <em>The number of</em> <em><strong>condition events</strong></em> <em>handled in this state (overriding default of none)</em></li>
<li>if nOverrides &gt; 0<ul>
<li>for each condition c between 1 and nOverrides<ul>
<li>thisCondition (1 byte) - <em>(the index of the condition whose events are handled)</em></li>
</ul>
</li>
<li>thisState (1 byte) - <em>(the state to go to if a thisCondition event occurs)</em></li>
</ul>
</li>
</ul>
</li>
<li>for each global timer between 1 and nGlobalTimers (nGlobalTimers must be retrieved earlier, using command 'H' above)<ul>
<li>linkedOutputChannel (1-byte) - <em>index of an output channel in outputDescriptionArray. 255 = no channel linked).</em></li>
</ul>
</li>
<li>for each global timer between 1 and nGlobalTimers<ul>
<li>onMessage (1-byte). <em>This is the index of a message set previously with command 'L' above, to send when the timer starts.</em></li>
</ul>
</li>
<li><em>Note: The target module for onMessage is defined by linkedOutputChannel (above), if linkedOutputChannel is a module port.</em></li>
<li>for each global timer between 1 and nGlobalTimers<ul>
<li>offMessage (1-byte). <em>This is the index of a message set previously with command 'L' above, to send when the timer starts.</em></li>
</ul>
</li>
<li><em>Note: The target module for offMessage is defined by linkedOutputChannel (above), if linkedOutputChannel is a module port.</em></li>
<li>for each global timer between 1 and nGlobalTimers<ul>
<li>loopMode (1-byte). <em>Set to 0 (default) if a one-shot timer, 1 to use the timer in loop mode</em></li>
</ul>
</li>
<li>for each global timer between 1 and nGlobalTimers<ul>
<li>sendGlobalTimerEvents (1-byte). <em>Set to 1 (default) to generate global timer on and off events. Set to 0 to disable them.</em></li>
</ul>
</li>
<li>for each global counter between 1 and nGlobalCounters (nGlobalCounters must be retrieved earlier, using command 'H' above)<ul>
<li>attachedEvent(1-byte). <em>This is the index of a behavior event to count.</em></li>
</ul>
</li>
<li>for each condition between 1 and nConditions (nConditions must be retrieved earlier, using command 'H' above)<ul>
<li>conditionChannel(1-byte). <em>This is an input channel index in inputDescriptionArray.</em></li>
</ul>
</li>
<li>for each condition between 1 and nConditions (nConditions must be retrieved earlier, using command 'H' above)<ul>
<li>conditionValue(1-byte). 0 = low, 1 = high. <em>Defines the state of the channel when the condition is true.</em></li>
</ul>
</li>
<li>for each state s between 1 and nStates<ul>
<li>stateTimer[s] (4 bytes; 32-bit int). <em>This state's internal timer (units = state machine cycles, 1 cycle = timerPeriod returned from 'H' above).</em></li>
</ul>
</li>
<li>for each global timer t between 1 and nGlobalTimers<ul>
<li>globalTimer[t] (4 bytes; 32-bit int). <em>Duration of global timer t (units = state machine cycles).</em></li>
</ul>
</li>
<li>for each global timer t between 1 and nGlobalTimers<ul>
<li>globalTimerOnsetDelay[t] (4 bytes; 32-bit int). <em>Onset delay of global timer t (units = state machine cycles).</em></li>
</ul>
</li>
<li>for each global timer t between 1 and nGlobalTimers<ul>
<li>globalTimerLoopInterval[t] (4 bytes; 32-bit int). <em>Delay between timer loop iterations (units = state machine cycles).</em></li>
</ul>
</li>
<li>for each global counter between 1 and nGlobalCounters<ul>
<li>globalCounterThreshold[t] (4 bytes; 32-bit int). <em>Threshold (units = instances of the event being counted).</em></li>
</ul>
</li>
<li>NOTE: The state machine will return a confirmation byte to indicate successful transmission of the state machine description, on the next call to RunStateMachine. This saves 1 read/write cycle, and reduces dead-time.</li>
</ul>
</li>
<li><strong>'R'</strong> (ASCII 82): <strong>Run state machine.</strong><ul>
<li>If a new state machine was sent prior to calling 'R', the state machine returns a byte (1) to confirm.</li>
<li>While the trial is running, event codes and soft-codes are returned via the serial report as follows:<ul>
<li>Op-code (byte 1) = 1 if the message is an event, and 2 if the message is a soft code</li>
<li>If op-code 1,<ul>
<li>nEvents (byte 2) - <em>number of events returned</em></li>
</ul>
</li>
<li>for each event between 1 and nEvents
        - Event code (1 byte)</li>
<li>If op-code 2,<ul>
<li>Soft code (byte 2) = the soft code to pass to the <a href="../../user-guide/function-reference/#softcodehandlerfunction">soft code handler function</a>.
<strong>Exit state</strong>: If event code 255 was returned, the state machine has reached an exit state. It then sends the trial's timing data as follows:</li>
</ul>
</li>
<li>Trial start timestamp in milliseconds (4 bytes; 32-bit integer)</li>
<li>nTimestamps (2 bytes; 16-bit integer) - <em>the number of timestamps to be transmitted</em></li>
<li>for each timestamp between 1 and nTimestamps:<ul>
<li>Timestamp (4 bytes; 32-bit integer) - <em>for each event recorded during the trial, a 32-bit timestamp. Units = 100us state machine cycles following trial start.</em></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>'<strong>X</strong>' (ASCII 88): <strong>Force-exit the currently running state machine, and return the partial trial's data</strong>.<ul>
<li>No data follows.</li>
<li>The state machine then returns the data in same format as for 'R' command above.</li>
</ul>
</li>
<li><strong>'Z'</strong> (ASCII 90): <strong>Disconnect state machine from the USB serial port</strong>.<ul>
<li>No data follows.</li>
<li>This resets several program variables to prepare the state machine for its next connection</li>
</ul>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2023 Sanworks LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.indexes", "content.action.edit"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>